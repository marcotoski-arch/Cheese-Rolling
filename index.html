<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cheese Rolling â€” v5.5</title>

  <style>
    html,body{
      margin:0;
      height:100%;
      background:#081024;
      overflow:hidden;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:#eaf0ff;
    }
    canvas{position:absolute;inset:0}
  </style>
</head>

<body>
<canvas id="c"></canvas>

<script>
(() => {

  /* =========================================================
     FOTO REALI (file nella ROOT del repository)
     ========================================================= */
  const faceAnna = new Image();
  faceAnna.src = 'Foto Anna.jpg';

  const faceMarco = new Image();
  faceMarco.src = 'Foto Marco.jpg';

  /* =========================================================
     CANVAS SETUP
     ========================================================= */
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');

  function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  /* =========================================================
     WORLD / PLAYER
     ========================================================= */
  let t = 0;
  let character = 'Anna';

  const groundY = () => canvas.height * 0.75;

  /* =========================================================
     DISEGNO RUNNER (VERSIONE SISTEMATA)
     ========================================================= */
  function drawRunner(x, y, phase, name){
    ctx.save();
    ctx.translate(x, y);

    const skin = '#f2c7a5';

    /* COLLO */
    ctx.fillStyle = skin;
    ctx.fillRect(-4, 10, 8, 10);

    /* ===== TESTA CON FOTO ===== */
    const face = (name === 'Anna') ? faceAnna : faceMarco;
    const faceOk = face.complete && face.naturalWidth > 0;

    if(faceOk){
      ctx.save();
      ctx.beginPath();
      ctx.arc(0, 0, 14, 0, Math.PI * 2);
      ctx.clip();
      ctx.drawImage(face, -14, -14, 28, 28);
      ctx.restore();

      ctx.strokeStyle = 'rgba(0,0,0,0.4)';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.arc(0, 0, 14, 0, Math.PI * 2);
      ctx.stroke();
    } else {
      ctx.fillStyle = skin;
      ctx.beginPath();
      ctx.arc(0,0,14,0,Math.PI*2);
      ctx.fill();
    }

    /* CORPO */
    ctx.fillStyle = (name === 'Anna') ? '#7a5cff' : '#2f7bff';
    ctx.fillRect(-12, 24, 24, 34);

    /* GAMBE (semplici) */
    ctx.strokeStyle = '#2b2f3a';
    ctx.lineWidth = 5;
    ctx.beginPath();
    ctx.moveTo(-6, 58);
    ctx.lineTo(-6 + Math.sin(phase)*6, 80);
    ctx.moveTo(6, 58);
    ctx.lineTo(6 - Math.sin(phase)*6, 80);
    ctx.stroke();

    ctx.restore();
  }

  /* =========================================================
     LOOP
     ========================================================= */
  function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    /* cielo */
    const g = ctx.createLinearGradient(0,0,0,canvas.height);
    g.addColorStop(0,'#0a1a39');
    g.addColorStop(1,'#7bb4ff');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    /* terreno */
    ctx.fillStyle = '#2c332b';
    ctx.fillRect(0, groundY(), canvas.width, canvas.height);

    /* runner */
    drawRunner(
      canvas.width * 0.3,
      groundY() - 80,
      t,
      character
    );

    t += 0.08;
    requestAnimationFrame(loop);
  }

  loop();

})();
</script>
</body>
</html>
